---
title: "11_correlations"
author: "Jackie"
date: "11/11/2020"
output: html_notebook
---

```{r, message=FALSE}
library(glmnet)
library(glmpath)
library(lars)
library(tidyverse)
library(dynutils)
library(readxl)
library(haven)
library(naniar)
library(pscl)
library(MASS)
library(stringr)
library(sjPlot)
library(directlabels)
library(caret)

set.seed(1234)
```


```{r, message=FALSE, echo=FALSE}
graph_net_fp <- "~/Box/Mooddata_Coordinating/1_Lab_Coordinating/Users/JackieSchwartz/PHIND_RS_and_Suicide/Octo2020Analysis/siq_graph.csv"

graph_net <- read_csv(graph_net_fp)
```

```{r}
options(scipen=999) 
z_score <- function(x) {
diff_mu <- x - mean(x, na.rm = T)
sd <- sd(x, na.rm = T)
diff_mu / sd
}
```


# correlations
```{r}
graph_net_stand <-
  graph_net %>%
  mutate(ELS_ID = factor(ELS_ID),
         KSADS_Child_Race_by_P.T1 = factor(KSADS_Child_Race_by_P.T1),
         sex_child = factor(sex_child),
         KSADS_Child_Race_by_P.T1_bin = ifelse(KSADS_Child_Race_by_P.T1 == "1", "1", "0"),
         KSADS_Child_Race_by_P.T1_bin = factor(KSADS_Child_Race_by_P.T1_bin)
  ) %>%
  dplyr::select(-KSADS_Child_Race_by_P.T1, -T1_KSADS_C_or_P_Thoughts, -T1_KSADS_C_or_P_bx, -siq_total_log) %>%
  # stnadardizing variables
  mutate_at(vars(-ELS_ID, -sex_child, -KSADS_Child_Race_by_P.T1_bin, -meds_baseline), z_score) 
```

# siq
```{r}
summary(lm(siq_total.T3 ~ T1_YSR_old_Internalizing_Problems_Total_Score, data = graph_net_stand))# 0.18128036094823590796

summary(lm(siq_total.T3 ~ caudIFG_R_34.deg, data = graph_net_stand)) # -0.2824903459292207319

summary(lm(siq_total.T3 ~ caudvlPrG_L_63.deg, data = graph_net_stand)) # -0.15010553189441616651 

summary(lm(siq_total.T3 ~ SN_R_226.wm_z, data = graph_net_stand)) # 0.2096494954183860393 

summary(lm(siq_total.T3 ~ medventFuG_L_105.deg, data = graph_net_stand)) # 0.2285399404305633875

summary(lm(siq_total.T3 ~ intlatITG_L_95.deg, data = graph_net_stand)) # 0.18437829882033732187

summary(lm(siq_total.T3 ~ sgCG_R_188.eig_cent, data = graph_net_stand)) # 0.1396439544933366084

summary(lm(siq_total.T3 ~ rostdorIPL_R_138.wm_z, data = graph_net_stand)) # -0.06983533127424290665
```

# ysr
```{r}
summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ intlatITG_L_95.eig_cent, data = graph_net_stand))# 0.32188065125647974396

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ factor(sex_child), data = graph_net_stand)) # 0.5692

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ medventFuG_R_106.deg, data = graph_net_stand)) # 0.25507502029552148182

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ T1_YSR_old_Internalizing_Problems_Total_Score, data = graph_net_stand)) # 0.28570847561036466500

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ Age_S1.T1, data = graph_net_stand)) # -0.266573448671081958

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ caudIFG_R_34.deg, data = graph_net_stand)) # -0.28003105279957468676

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ caudPhG_L_111.eff_loc, data = graph_net_stand)) # 0.22667814420707577128

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ vIFG_L_39.eig_cent, data = graph_net_stand)) # -0.24965093226165530060

summary(lm(T3_YSR_New_Internalizing_Problems_Total_Score ~ orbOrG_R_44.pc, data = graph_net_stand)) # -0.22765427879934271860
```


# participant characteristic correlations
```{r}
summary(lm(siq_total.T3 ~ sex_child, data = graph_net_stand))# 0.43 (p = 0.0258)

summary(lm(siq_total.T3 ~ KSADS_Child_Race_by_P.T1_bin, data = graph_net_stand)) #-0.07 (p = 0.726)

summary(lm(siq_total.T3 ~ Age_S1.T1, data = graph_net_stand)) # -0.20 (p = 0.0396)

summary(lm(siq_total.T3 ~ Tanner_Average.T1, data = graph_net_stand)) # 0.03 (p = .743) 

summary(lm(siq_total.T3 ~ T1_YSR_old_Internalizing_Problems_Total_Score, data = graph_net_stand)) # 0.18 (p = 0.0592)

summary(lm(siq_total.T3 ~ interval_s2t1_s1t3, data = graph_net_stand)) # 0.20 (p = 0.035)

summary(lm(siq_total.T3 ~ sumsev_type_t1, data = graph_net_stand)) # 0.16 (p = 0.0937)

summary(lm(siq_total.T3 ~ sss_t1, data = graph_net_stand)) # 0.04 (p = 0.675)

summary(lm(siq_total.T3 ~ Parent_Education.T1, data = graph_net_stand)) # 0.13 (p = 0.184)

summary(lm(siq_total.T3 ~ MeanFD, data = graph_net_stand)) # 0.016 (p=0.8691)

summary(lm(siq_total.T3 ~ BMI, data = graph_net_stand)) # 0.00000211044348803693 (p=1)


p <- c(0.0258, 0.726, 0.0396, .743 , 0.0592, 0.035, 0.0937,0.675, 0.184, 0.8691, 1)
p.adjust(p, method ="fdr", n = length(p))
# 0.1320000 0.8255556 0.1320000 0.8255556 0.1480000 0.1320000 0.1874000 0.8255556 0.3066667, 0.8691000

summary(lm(siq_total.T3 ~ Tanner_Average.T1*sex_child, data = graph_net_stand)) # just sex
summary(lm(siq_total.T3 ~ meds_baseline, data = graph_net_stand)) # 0.029179 (p=.913)
```

## correlations with mean fd
```{r}
summary(lm(MeanFD ~ T1_YSR_old_Internalizing_Problems_Total_Score, data = graph_net_stand)) # -0.0410864826523191228880 (p=0.671)
summary(lm(MeanFD ~ caudIFG_R_34.deg, data = graph_net_stand)) # 0.112125241372850806276 (p=0.246)
summary(lm(MeanFD ~ caudvlPrG_L_63.deg, data = graph_net_stand)) # 0.148532746729094278226 (p=0.123)
summary(lm(MeanFD ~ SN_R_226.wm_z, data = graph_net_stand)) # -0.017570896445226486665 (p=0.856)
summary(lm(MeanFD ~ medventFuG_L_105.deg, data = graph_net_stand)) # -0.026220436165970469750 (p=0.787)
summary(lm(MeanFD ~ intlatITG_L_95.deg, data = graph_net_stand)) # -0.27178368207123015932 (p=0.00425)**
summary(lm(MeanFD ~ sgCG_R_188.eig_cent, data = graph_net_stand)) # -0.077012712801159635689 (p=0.426)
summary(lm(MeanFD ~ rostdorIPL_R_140.wm_z, data = graph_net_stand)) # -0.0177039951528672016845 (p=0.855)

p <- c(0.671, p=0.246, 0.123, 0.856 , 0.787, 0.00425, 0.426, 0.855)
p.adjust(p, method ="fdr", n = length(p))
# 0.856 0.656 0.492 0.856 0.856 0.034 0.852 0.856
```

Does degree of the L inlatITG correlate with SI above and beyond mean FD?
```{r}
summary(lm(siq_total.T3 ~ intlatITG_L_95.deg + MeanFD, data = graph_net_stand))
```
yes - intlatITG is associated with severity of SI above and beyond MeanFD.
